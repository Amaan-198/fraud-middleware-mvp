{
  "permissions": {
    "allow": [
      "Bash(python test_security.py:*)",
      "Bash(curl:*)",
      "Bash(python:*)",
      "Bash('SOURCE_ID=manual_test_$(date +%s)')",
      "Bash(for i in {1..110})",
      "Bash(do curl -s -X POST http://localhost:8000/v1/decision -H 'Content-Type: application/json' -H 'X-Source-ID: $SOURCE_ID' -d {\"\"user_id\"\":\"\"test\"\",\"\"device_id\"\":\"\"dev1\"\",\"\"amount\"\":100,\"\"timestamp\"\":\"\"2024-01-01T00:00:00Z\"\",\"\"location\"\":\"\"Test\"\"})",
      "Bash(done)",
      "Bash(bash -c 'SOURCE_ID=\"\"manual_$(date +%s)\"\" && echo \"\"Source: $SOURCE_ID\"\" && for i in {1..110}; do curl -s -X POST http://localhost:8000/v1/decision -H \"\"X-Source-ID: $SOURCE_ID\"\" -H \"\"Content-Type: application/json\"\" -d \"\"{\\\"\"user_id\\\"\":\\\"\"test\\\"\",\\\"\"device_id\\\"\":\\\"\"dev\\\"\",\\\"\"amount\\\"\":100,\\\"\"timestamp\\\"\":\\\"\"2024-01-01T00:00:00Z\\\"\",\\\"\"location\\\"\":\\\"\"Test\\\"\"}\"\" >/dev/null && sleep 0.05; done && sleep 2 && curl -s \"\"http://localhost:8000/v1/security/events?source_id=$SOURCE_ID\"\" | python -m json.tool | grep -A5 \"\"api_abuse\"\"')",
      "Bash(pkill:*)",
      "Bash(findstr:*)",
      "Bash(pytest:*)",
      "Bash(git checkout:*)",
      "Bash(bash -c 'SOURCE_ID=\"\"brute_force_test_$(date +%s)\"\" && echo \"\"Testing Brute Force Detection with source: $SOURCE_ID\"\" && echo \"\"\"\" && for i in {1..12}; do curl -s -X POST http://localhost:8000/v1/decision -H \"\"X-Source-ID: $SOURCE_ID\"\" -H \"\"X-Auth-Result: failed\"\" -H \"\"Content-Type: application/json\"\" -d \"\"{\\\"\"user_id\\\"\":\\\"\"test\\\"\",\\\"\"device_id\\\"\":\\\"\"dev\\\"\",\\\"\"amount\\\"\":100,\\\"\"timestamp\\\"\":\\\"\"2024-01-01T00:00:00Z\\\"\",\\\"\"location\\\"\":\\\"\"Test\\\"\"}\"\" >/dev/null 2>&1 && sleep 0.6; done && echo \"\"Checking security events...\"\" && curl -s \"\"http://localhost:8000/v1/security/events?source_id=$SOURCE_ID&limit=5\"\" | python -m json.tool | grep -E \"\"(threat_type|threat_level|description)\"\" | head -9')",
      "Bash(bash -c 'SOURCE_ID=\"\"exfil_test_$(date +%s)\"\" && echo \"\"Testing Data Exfiltration Detection with source: $SOURCE_ID\"\" && echo \"\"Establishing baseline (6 requests with ~30 records)...\"\" && for i in {1..6}; do curl -s -X POST http://localhost:8000/v1/decision -H \"\"X-Source-ID: $SOURCE_ID\"\" -H \"\"X-Records-Accessed: 30\"\" -H \"\"Content-Type: application/json\"\" -d \"\"{\\\"\"user_id\\\"\":\\\"\"test\\\"\",\\\"\"device_id\\\"\":\\\"\"dev\\\"\",\\\"\"amount\\\"\":100,\\\"\"timestamp\\\"\":\\\"\"2024-01-01T00:00:00Z\\\"\",\\\"\"location\\\"\":\\\"\"Test\\\"\"}\"\" >/dev/null 2>&1 && sleep 0.3; done && echo \"\"Triggering exfiltration (150 records = 5x baseline)...\"\" && curl -s -X POST http://localhost:8000/v1/decision -H \"\"X-Source-ID: $SOURCE_ID\"\" -H \"\"X-Records-Accessed: 150\"\" -H \"\"Content-Type: application/json\"\" -d \"\"{\\\"\"user_id\\\"\":\\\"\"test\\\"\",\\\"\"device_id\\\"\":\\\"\"dev\\\"\",\\\"\"amount\\\"\":100,\\\"\"timestamp\\\"\":\\\"\"2024-01-01T00:00:00Z\\\"\",\\\"\"location\\\"\":\\\"\"Test\\\"\"}\"\" >/dev/null 2>&1 && sleep 1 && echo \"\"Checking security events...\"\" && curl -s \"\"http://localhost:8000/v1/security/events?source_id=$SOURCE_ID&limit=3\"\" | python -m json.tool | grep -E \"\"(threat_type|threat_level|description)\"\" | head -9')",
      "Bash(bash -c 'SOURCE_ID=\"\"insider_test_$(date +%s)\"\" && echo \"\"Testing Insider Threat Detection with source: $SOURCE_ID\"\" && echo \"\"Simulating off-hours access...\"\" && for i in {1..8}; do curl -s -X POST http://localhost:8000/v1/decision -H \"\"X-Source-ID: $SOURCE_ID\"\" -H \"\"X-Access-Time: off-hours\"\" -H \"\"Content-Type: application/json\"\" -d \"\"{\\\"\"user_id\\\"\":\\\"\"test\\\"\",\\\"\"device_id\\\"\":\\\"\"dev\\\"\",\\\"\"amount\\\"\":100,\\\"\"timestamp\\\"\":\\\"\"2024-01-01T00:00:00Z\\\"\",\\\"\"location\\\"\":\\\"\"Test\\\"\"}\"\" >/dev/null 2>&1 && sleep 0.6; done && sleep 1 && echo \"\"Checking security events...\"\" && curl -s \"\"http://localhost:8000/v1/security/events?source_id=$SOURCE_ID&limit=3\"\" | python -m json.tool | grep -E \"\"(threat_type|threat_level|description)\"\" | head -9')",
      "Bash(bash -c 'SOURCE_ID=\"\"api_abuse_test_$(date +%s)\"\" && echo \"\"Testing API Abuse Detection with source: $SOURCE_ID\"\" && echo \"\"Sending 120 rapid requests...\"\" && for i in {1..120}; do curl -s -X POST http://localhost:8000/v1/decision -H \"\"X-Source-ID: $SOURCE_ID\"\" -H \"\"Content-Type: application/json\"\" -d \"\"{\\\"\"user_id\\\"\":\\\"\"test\\\"\",\\\"\"device_id\\\"\":\\\"\"dev\\\"\",\\\"\"amount\\\"\":100,\\\"\"timestamp\\\"\":\\\"\"2024-01-01T00:00:00Z\\\"\",\\\"\"location\\\"\":\\\"\"Test\\\"\"}\"\" >/dev/null 2>&1; done && sleep 1 && echo \"\"Checking security events...\"\" && curl -s \"\"http://localhost:8000/v1/security/events?source_id=$SOURCE_ID&limit=3\"\" | python -m json.tool | grep -E \"\"(threat_type|threat_level|description)\"\" | head -9')",
      "Bash(bash -c 'SOURCE_ID=\"\"quick_api_test\"\" && echo \"\"Sending 50 rapid requests...\"\" && for i in {1..50}; do curl -s -X POST http://localhost:8000/v1/decision -H \"\"X-Source-ID: $SOURCE_ID\"\" -H \"\"Content-Type: application/json\"\" -d \"\"{\\\"\"user_id\\\"\":\\\"\"test\\\"\",\\\"\"device_id\\\"\":\\\"\"dev\\\"\",\\\"\"amount\\\"\":100,\\\"\"timestamp\\\"\":\\\"\"2024-01-01T00:00:00Z\\\"\",\\\"\"location\\\"\":\\\"\"Test\\\"\"}\"\" >/dev/null 2>&1; done && sleep 2 && echo \"\"Events:\"\" && curl -s \"\"http://localhost:8000/v1/security/events?source_id=$SOURCE_ID&limit=2\"\" | python -m json.tool | grep -E \"\"(threat_type|threat_level)\"\" | head -4')"
    ],
    "deny": [],
    "ask": []
  }
}
